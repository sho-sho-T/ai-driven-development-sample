<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 720" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <style>
      .title { font-size: 18px; font-weight: 700; fill: #1a1a2e; }
      .layer-label { font-size: 13px; font-weight: 600; fill: #fff; }
      .section-label { font-size: 12px; font-weight: 600; fill: #334155; }
      .item-label { font-size: 11px; fill: #475569; }
      .item-bold { font-size: 11px; font-weight: 600; fill: #1e293b; }
      .port-label { font-size: 10px; fill: #0369a1; font-weight: 600; }
      .note-label { font-size: 10px; fill: #64748b; font-style: italic; }
      .arrow-label { font-size: 10px; fill: #64748b; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="960" height="720" fill="#f8fafc" rx="8"/>

  <!-- Title -->
  <text x="480" y="32" text-anchor="middle" class="title">Development Environment Architecture</text>

  <!-- ==================== Host Machine ==================== -->
  <rect x="20" y="50" width="920" height="660" rx="12" fill="none" stroke="#94a3b8" stroke-width="2" stroke-dasharray="8,4"/>
  <rect x="20" y="50" width="140" height="26" rx="6" fill="#64748b"/>
  <text x="90" y="67" text-anchor="middle" class="layer-label">Host Machine</text>

  <!-- VSCode -->
  <rect x="40" y="90" width="160" height="60" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="120" y="112" text-anchor="middle" class="item-bold">VSCode</text>
  <text x="120" y="128" text-anchor="middle" class="item-label">DevContainer 拡張</text>

  <!-- Source Code (Host) -->
  <rect x="220" y="90" width="200" height="60" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="320" y="112" text-anchor="middle" class="item-bold">Source Code (Host)</text>
  <text x="320" y="128" text-anchor="middle" class="item-label">bind mount → /workspace</text>

  <!-- Browser -->
  <rect x="760" y="90" width="160" height="60" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="840" y="112" text-anchor="middle" class="item-bold">Browser</text>
  <text x="840" y="128" text-anchor="middle" class="item-label">localhost:3000 / 54323</text>

  <!-- Arrow: VSCode → DevContainer -->
  <line x1="120" y1="150" x2="120" y2="180" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="134" y="170" class="arrow-label">Remote</text>

  <!-- Arrow: Source → DevContainer -->
  <line x1="320" y1="150" x2="320" y2="180" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrow-orange)"/>
  <text x="334" y="170" class="arrow-label">bind</text>

  <!-- Arrow: Browser → Ports -->
  <line x1="840" y1="150" x2="840" y2="180" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="854" y="170" class="arrow-label">forwardPorts</text>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#64748b"/>
    </marker>
    <marker id="arrow-orange" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#f59e0b"/>
    </marker>
    <marker id="arrow-green" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#10b981"/>
    </marker>
  </defs>

  <!-- ==================== DevContainer ==================== -->
  <rect x="40" y="180" width="900" height="510" rx="10" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
  <rect x="40" y="180" width="220" height="26" rx="6" fill="#2563eb"/>
  <text x="150" y="197" text-anchor="middle" class="layer-label">DevContainer (Ubuntu)</text>

  <!--  mise (Tool Management)  -->
  <rect x="60" y="220" width="380" height="80" rx="8" fill="#fff" stroke="#e2e8f0" stroke-width="1"/>
  <text x="70" y="238" class="section-label">mise (ツール管理)</text>
  <text x="70" y="256" class="item-label">mise.toml → shims PATH</text>

  <!-- Tool boxes -->
  <rect x="70" y="266" width="70" height="24" rx="4" fill="#dbeafe" stroke="#93c5fd"/>
  <text x="105" y="282" text-anchor="middle" class="item-bold">bun</text>
  <rect x="148" y="266" width="70" height="24" rx="4" fill="#dbeafe" stroke="#93c5fd"/>
  <text x="183" y="282" text-anchor="middle" class="item-bold">node 22</text>
  <rect x="226" y="266" width="80" height="24" rx="4" fill="#dbeafe" stroke="#93c5fd"/>
  <text x="266" y="282" text-anchor="middle" class="item-bold">supabase</text>
  <rect x="314" y="266" width="50" height="24" rx="4" fill="#dbeafe" stroke="#93c5fd"/>
  <text x="339" y="282" text-anchor="middle" class="item-bold">gh</text>

  <!--  Volume Mounts  -->
  <rect x="460" y="220" width="260" height="80" rx="8" fill="#fff" stroke="#e2e8f0" stroke-width="1"/>
  <text x="470" y="238" class="section-label">Docker Volumes (永続化)</text>
  <text x="470" y="258" class="item-label">node_modules</text>
  <text x="590" y="258" class="item-label">mise cache</text>
  <text x="470" y="278" class="item-label">.claude</text>
  <text x="590" y="278" class="item-label">.config/gh</text>

  <!--  Lifecycle  -->
  <rect x="740" y="220" width="180" height="80" rx="8" fill="#fff" stroke="#e2e8f0" stroke-width="1"/>
  <text x="750" y="238" class="section-label">Lifecycle Scripts</text>
  <text x="750" y="258" class="item-bold">post-create.sh</text>
  <text x="757" y="272" class="item-label">mise/bun/shell/git setup</text>
  <text x="750" y="290" class="item-bold">post-start.sh</text>

  <!-- ==================== Application Layer ==================== -->
  <rect x="60" y="320" width="520" height="180" rx="8" fill="#fff" stroke="#6366f1" stroke-width="1.5"/>
  <rect x="60" y="320" width="180" height="24" rx="6" fill="#6366f1"/>
  <text x="150" y="336" text-anchor="middle" class="layer-label">apps/web (@sample/web)</text>

  <!-- TanStack Start -->
  <rect x="80" y="356" width="140" height="50" rx="6" fill="#f0fdf4" stroke="#86efac" stroke-width="1"/>
  <text x="150" y="376" text-anchor="middle" class="item-bold">TanStack Start</text>
  <text x="150" y="392" text-anchor="middle" class="item-label">SSR React</text>

  <!-- Vite -->
  <rect x="240" y="356" width="100" height="50" rx="6" fill="#fdf4ff" stroke="#d8b4fe" stroke-width="1"/>
  <text x="290" y="376" text-anchor="middle" class="item-bold">Vite</text>
  <text x="290" y="392" text-anchor="middle" class="port-label">:3000</text>

  <!-- Nitro -->
  <rect x="360" y="356" width="100" height="50" rx="6" fill="#fdf4ff" stroke="#d8b4fe" stroke-width="1"/>
  <text x="410" y="376" text-anchor="middle" class="item-bold">Nitro</text>
  <text x="410" y="392" text-anchor="middle" class="item-label">Server Runtime</text>

  <!-- File Router -->
  <rect x="80" y="418" width="200" height="40" rx="6" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"/>
  <text x="180" y="438" text-anchor="middle" class="item-label">src/routes/ (File-based Router)</text>

  <!-- Components -->
  <rect x="300" y="418" width="150" height="40" rx="6" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"/>
  <text x="375" y="438" text-anchor="middle" class="item-label">src/components/</text>

  <!-- Port label -->
  <rect x="480" y="370" width="80" height="22" rx="4" fill="#0ea5e9" opacity="0.15"/>
  <text x="520" y="385" text-anchor="middle" class="port-label">:3000</text>

  <!-- ==================== Packages ==================== -->
  <rect x="60" y="520" width="520" height="80" rx="8" fill="#fff" stroke="#8b5cf6" stroke-width="1.5"/>
  <rect x="60" y="520" width="120" height="24" rx="6" fill="#8b5cf6"/>
  <text x="120" y="536" text-anchor="middle" class="layer-label">packages/</text>

  <!-- modules -->
  <rect x="80" y="554" width="220" height="34" rx="6" fill="#faf5ff" stroke="#c4b5fd" stroke-width="1"/>
  <text x="190" y="574" text-anchor="middle" class="item-bold">modules/ (Bounded Contexts)</text>

  <!-- shared-kernel -->
  <rect x="320" y="554" width="240" height="34" rx="6" fill="#faf5ff" stroke="#c4b5fd" stroke-width="1"/>
  <text x="440" y="568" text-anchor="middle" class="item-bold">shared-kernel/</text>
  <text x="440" y="582" text-anchor="middle" class="item-label">public (BE/FE) + server (BE)</text>

  <!-- ==================== Docker-in-Docker (Supabase) ==================== -->
  <rect x="600" y="320" width="320" height="280" rx="8" fill="#fff" stroke="#10b981" stroke-width="1.5"/>
  <rect x="600" y="320" width="200" height="24" rx="6" fill="#059669"/>
  <text x="700" y="336" text-anchor="middle" class="layer-label">Docker-in-Docker (DinD)</text>

  <!-- Supabase label -->
  <rect x="620" y="356" width="280" height="24" rx="4" fill="#ecfdf5"/>
  <text x="760" y="372" text-anchor="middle" class="section-label">Supabase Services</text>

  <!-- PostgreSQL -->
  <rect x="620" y="392" width="130" height="44" rx="6" fill="#d1fae5" stroke="#6ee7b7" stroke-width="1"/>
  <text x="685" y="412" text-anchor="middle" class="item-bold">PostgreSQL</text>
  <text x="685" y="426" text-anchor="middle" class="port-label">:54322</text>

  <!-- PostgREST -->
  <rect x="770" y="392" width="130" height="44" rx="6" fill="#d1fae5" stroke="#6ee7b7" stroke-width="1"/>
  <text x="835" y="412" text-anchor="middle" class="item-bold">PostgREST API</text>
  <text x="835" y="426" text-anchor="middle" class="port-label">:54321</text>

  <!-- Studio -->
  <rect x="620" y="448" width="130" height="44" rx="6" fill="#d1fae5" stroke="#6ee7b7" stroke-width="1"/>
  <text x="685" y="468" text-anchor="middle" class="item-bold">Studio (GUI)</text>
  <text x="685" y="482" text-anchor="middle" class="port-label">:54323</text>

  <!-- GoTrue -->
  <rect x="770" y="448" width="130" height="44" rx="6" fill="#d1fae5" stroke="#6ee7b7" stroke-width="1"/>
  <text x="835" y="468" text-anchor="middle" class="item-bold">GoTrue (Auth)</text>
  <text x="835" y="482" text-anchor="middle" class="item-label">認証サービス</text>

  <!-- Inbucket -->
  <rect x="620" y="504" width="130" height="44" rx="6" fill="#d1fae5" stroke="#6ee7b7" stroke-width="1"/>
  <text x="685" y="524" text-anchor="middle" class="item-bold">Inbucket</text>
  <text x="685" y="538" text-anchor="middle" class="port-label">:54324</text>

  <!-- supabase/ config -->
  <rect x="770" y="504" width="130" height="44" rx="6" fill="#f0fdf4" stroke="#a7f3d0" stroke-width="1"/>
  <text x="835" y="520" text-anchor="middle" class="item-bold">supabase/</text>
  <text x="835" y="536" text-anchor="middle" class="item-label">config + migrations</text>

  <!-- DinD note -->
  <text x="760" y="572" text-anchor="middle" class="note-label">localhost でアクセス可能</text>

  <!-- ==================== Arrows between layers ==================== -->

  <!-- App → DB -->
  <line x1="560" y1="400" x2="618" y2="414" stroke="#10b981" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrow-green)"/>

  <!-- ==================== mise tasks legend ==================== -->
  <rect x="60" y="620" width="520" height="60" rx="8" fill="#fff" stroke="#e2e8f0" stroke-width="1"/>
  <text x="70" y="638" class="section-label">mise tasks (開発コマンド)</text>
  <text x="70" y="660" class="item-bold">mr dev</text>
  <text x="130" y="660" class="item-label">→ apps/web dev server</text>
  <text x="280" y="660" class="item-bold">mr db</text>
  <text x="320" y="660" class="item-label">→ supabase start</text>
  <text x="440" y="660" class="item-bold">mr db:stop</text>
  <text x="505" y="660" class="item-label">/ db:reset</text>

  <!-- VSCode Extensions -->
  <rect x="600" y="620" width="320" height="60" rx="8" fill="#fff" stroke="#e2e8f0" stroke-width="1"/>
  <text x="610" y="638" class="section-label">VSCode Extensions (自動インストール)</text>
  <text x="610" y="658" class="item-label">ESLint / Prettier / Tailwind CSS / Docker</text>
  <text x="610" y="672" class="item-label">Auto Rename Tag</text>
</svg>
